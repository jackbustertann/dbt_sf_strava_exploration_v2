{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2024-08-26T18:04:53.652311Z", "invocation_id": "75c24e28-d95d-4562-ab47-c6b10497c07e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-26T18:04:45.480806Z", "completed_at": "2024-08-26T18:04:45.593633Z"}, {"name": "execute", "started_at": "2024-08-26T18:04:45.594734Z", "completed_at": "2024-08-26T18:04:50.815621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.445032119750977, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01b69cdc-0000-9e02-0000-e1e90017e446"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.dbt_sf_strava_exploration_v2.int_activity_streams__filled", "compiled": true, "compiled_code": "\n\nWITH activities AS (\n    SELECT activity_key, activity_id, elapsed_time_s\n    FROM STRAVA_STAGING.staging.stg_strava_activities\n    \n    WHERE loaded_timestamp_utc > (\n        SELECT MAX(loaded_timestamp_utc)\n        FROM STRAVA_STAGING.intermediate.int_activity_streams__filled\n    )\n    \n),\n\nactivity_streams AS (\n    SELECT *\n    FROM STRAVA_STAGING.staging.stg_strava_activity_streams\n    WHERE activity_id IN (\n        SELECT activity_id\n        FROM activities\n    )\n),\n\nactivity_streams_filled AS (\n    SELECT\n        md5(cast(coalesce(cast(activity_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(elapsed_time_s as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as activity_stream_filled_key,\n        CASE \n            WHEN activity_stream_key IS NULL THEN false\n            ELSE true \n        END AS is_recorded,\n        *\n    FROM (\n        SELECT \n            activities.activity_id AS activity_id,\n            time.value AS elapsed_time_s\n        FROM activities, \n            LATERAL FLATTEN(INPUT => ARRAY_GENERATE_RANGE(0, activities.elapsed_time_s)) time\n    ) AS elapsed_time_filled\n    NATURAL LEFT JOIN activity_streams\n)\n\nSELECT \n    -- surrogate keys\n    activity_stream_filled_key,\n    activity_stream_key,\n    activity_key,\n    -- natural keys\n    activity_id,\n    elapsed_time_s,\n    -- dimensions (boolean)\n    is_moving,\n    is_recorded,\n    -- measures (contextual)\n    latitude,\n    longitude,\n    temperature_c,\n    grade_percent,\n    elevation_m,\n    cadence_rpm,\n    -- measures (volume)\n    distance_m,\n    -- measures (intensity)\n    heartrate_bpm,\n    -- measures (performance)\n    speed_ms,\n    power_watts,\n    -- technical meta-data\n    CONVERT_TIMEZONE('UTC', DATE_TRUNC('second', current_timestamp)) AS loaded_timestamp_utc\nFROM activity_streams_filled", "relation_name": "STRAVA_STAGING.intermediate.int_activity_streams__filled"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-08-26T18:04:50.935374Z", "completed_at": "2024-08-26T18:04:50.952211Z"}, {"name": "execute", "started_at": "2024-08-26T18:04:50.953096Z", "completed_at": "2024-08-26T18:04:51.793871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9538328647613525, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b69cdc-0000-9d90-0000-e1e90018006a"}, "message": null, "failures": 0, "unique_id": "test.dbt_sf_strava_exploration_v2.not_null_int_activity_streams__filled_activity_stream_filled_key.68ccbbc48d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_stream_filled_key\nfrom STRAVA_STAGING.intermediate.int_activity_streams__filled\nwhere activity_stream_filled_key is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-08-26T18:04:51.895232Z", "completed_at": "2024-08-26T18:04:51.908618Z"}, {"name": "execute", "started_at": "2024-08-26T18:04:51.909529Z", "completed_at": "2024-08-26T18:04:53.563500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7540159225463867, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b69cdc-0000-9dfa-0000-e1e90017d3a6"}, "message": null, "failures": 0, "unique_id": "test.dbt_sf_strava_exploration_v2.unique_int_activity_streams__filled_activity_stream_filled_key.2b7aa0a550", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_stream_filled_key as unique_field,\n    count(*) as n_records\n\nfrom STRAVA_STAGING.intermediate.int_activity_streams__filled\nwhere activity_stream_filled_key is not null\ngroup by activity_stream_filled_key\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 9.878727197647095, "args": {"resource_types": [], "empty": false, "target": "staging", "require_explicit_package_overrides_for_builtin_materializations": true, "version_check": true, "strict_mode": false, "printer_width": 80, "macro_debugging": false, "include_saved_query": false, "cache_selected_only": false, "send_anonymous_usage_stats": true, "require_resource_names_without_spaces": false, "export_saved_queries": false, "project_dir": "/Users/jacktann/Documents/DS Projects/strava_exploration/dbt_projects/dbt_sf_strava_exploration_v2/dbt_sf_strava_exploration_v2", "defer": false, "quiet": false, "log_level": "info", "show": false, "populate_cache": true, "log_level_file": "debug", "favor_state": false, "indirect_selection": "eager", "exclude_resource_types": [], "log_file_max_bytes": 10485760, "static_parser": true, "which": "build", "write_json": true, "log_path": "/Users/jacktann/Documents/DS Projects/strava_exploration/dbt_projects/dbt_sf_strava_exploration_v2/dbt_sf_strava_exploration_v2/logs", "vars": {}, "invocation_command": "dbt build --target staging --select int_activity_streams__filled", "use_colors_file": true, "source_freshness_run_project_hooks": false, "use_colors": true, "exclude": [], "introspect": true, "log_format_file": "debug", "print": true, "partial_parse": true, "log_format": "default", "profiles_dir": "/Users/jacktann/Documents/DS Projects/strava_exploration/dbt_projects/dbt_sf_strava_exploration_v2/dbt_sf_strava_exploration_v2", "warn_error_options": {"include": [], "exclude": []}, "select": ["int_activity_streams__filled"], "partial_parse_file_diff": true, "enable_legacy_logger": false, "show_resource_report": false}}